# 1. 文件读写
## 1.1. open()方法
open()方法的返回值是一个file对象，可以将它赋值给一个变量（文件句柄）。其基本语法格式为：

```python
f = open(filename,mode)

filename：一个包含了你要访问的文件名称的字符串值，通常是一个文件路径
mode：打开文件的模式，默认是只读模式r
```

### 1.1.1. 打开模式
| 模式 | 操作       | 说明                                                                  |
|------|------------|-----------------------------------------------------------------------|
| r    | 只读       | 默认模式，如果文件不存在就报错，存在就正常读取                        |
| w    | 只写       | 如果文件不存在，新建文件然后写入；如果存在，先清空文件内容，再写入    |
| a    | 追加       | 如果文件不存在，新建文件，然后写入；如果存在，在文件的最后追加写入    |
| x    | 新建       | 如果文件存在则报错，如果不存在就新建文件，然后写入内容，比w模式更安全 |
| b    | 二进制模式 | 比如rb、wb、ab，以byte类型操作数据                                    |
| +    | 读写模式   | 比如r+、w+、a+                                                        |

## 1.2. b模式
二进制模式，通常用来读取图片、视频等二进制文件。注意，它在读写的时候是以bytes类型读写的，因此获得是一个bytes对象而不是字符串。在这个读写过程中，需要自己指定编码格式。在使用带b的模式时要注意传入的数据类型为bytes类型。

## 1.3. +模式
- 对于w+模式，在读写之前都会清空文件的内容，建议不要使用！
- 对于a+模式，永远只能在文件的末尾写入，有局限性，建议不要使用！
- 对于r+模式，也就是读写模式，配合seek()和tell()方法，可以实现更多操作。

## 1.4. 编码问题
要读取非UTF-8编码的文件，需要给open()函数传入encoding参数。

```python
f = open('gbk.txt', 'r', encoding='gbk')
f.read()
```

## 1.5. 文件对象操作
### 1.5.1. f.read(size)
读取一定大小的数据，然后作为字符串或字节对象返回。size是一个可选的数字类型的参数，用于指定读取的数据量。当size被忽略了或者为负值，那么该文件的所有内容都将被读取且返回。

```python
f = open("test.txt", "r")

str = f.read()
print(str)

f.close()
```

### 1.5.2. f.reaedline()
从文件中读取一行n内容。换行符为‘\n’。如果返回一个空字符串，说明已经读取到最后一行。通常是读一行处理一行，并且不能回头只能前进。

```python
f = open("test.txt", "r")
str = f.readline()
print(str)
f.close()
```

### 1.5.3. f.readlines()
将文件中所有的行，一行一行全部读入一个列表内，按顺序一个一个作为列表的元素，并返回这个列表。将文件一次性读取内存存在一定的风险。但是有个好处就是每行都保存在列表里，可以随意读取。

```python
f = open("1.txt", "r")
a = f.readlines()
print(a)
f.close()
```

### 1.5.4. 遍历文件
几种不同的读取和遍历文件的方法比较：如果文件很小，read()一次性读取最方便；如果不能确定文件大小，反复调用read(size)比较保险；如果是配置文件，调用readlines()最方便。普通情况，使用for循环更好，速度更快。

```python
# 打开一个文件
f = open("1.txt", "r")

for line in f:
    print(line, end='')

# 关闭打开的文件
f.close()
```

### 1.5.5. f.write()
- 将字符串或bytes类型的数据写入文件内。
- write()动作可以多次重复进行，其实都是在内存中的操作，并不会立刻写回硬盘，直到执行close()方法后，才会将所有的写入操作反映到硬盘上。在这过程中，如果想将内存中的修改，立刻保存到硬盘上，可以使用f.flush()方法，但这可能造成数据的不一致。

```python
# 打开一个文件
f = open("/tmp/foo.txt", "w")

f.write("Python 是一种非常好的语言。\n我喜欢Python!!\n")

# 关闭打开的文件
f.close()
```

### 1.5.6. f.tell()
返回文件读写指针当前所处的位置，是从文件开头开始算起的字节数。

### 1.5.7. f.seek()
- 改变位置指针的位置, 可以使用`f.seek(offset, from_what)`方法。
- seek()经常和tell()方法配合使用。
- `from_what`的值，如果是0表示从文件开头计算，如果是1表示从文件读写指针的当前位置开始计算，2表示从文件的结尾开始计算，默认为0，例如：

offset：表示偏移量。
- seek(x,0) ： 从起始位置即文件首行首字符开始移动 x 个字符
- seek(x,1) ： 表示从当前位置往后移动x个字符
- seek(-x,2)：表示从文件的结尾往前移动x个字符

### 1.5.8. f.close()
关闭文件对象。当处理完一个文件后，调用f.close()来关闭文件并释放系统的资源。当文件关闭后，如果尝试再次调用该文件对象，则会抛出异常。

## 1.6. with关键字
with关键字用于Python的上下文管理器机制。为了防止诸如open这一类文件打开方法在操作过程出现异常或错误，或者最后忘了执行close方法，文件非正常关闭等可能导致文件泄露、破坏的问题。Python提供了with这个上下文管理器机制，保证文件会被正常关闭。在它的管理下，不需要再写close语句。注意缩进。

```python
with open('test.txt', 'w') as f:
    f.write('Hello, world!')


with open('log1') as obj1, open('log2','w') as obj2:
    s=obj1.read()
    obj2.write(s)
```